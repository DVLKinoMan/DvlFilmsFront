
<form [formGroup]="filmForm" (ngSubmit)="save()" style="width: 100%;" >
    <div style="width: 100%;">
        <div id = "little-bios" style="display: flex;">
            <div id="little-bio" style="display: flex">
                    <div id="poster">
                        <img [src]="model.photo?.image" 
                        [alt]="model.photo?.title"
                        onerror="this.src='assets/DefaultMovie.png'">
                        <div class="imdb-rating">
                            <a target="_blank" *ngIf="model.imdbPageUrl; else onlyLogo" href="{{model.imdbPageUrl}}">
                                <img class="imdb-logo" src="assets/ImdbLogo.png">
                            </a>
                            <ng-template #onlyLogo><img class="imdb-logo" src="assets/ImdbLogo.png"></ng-template>
                            <div *ngIf="model.imdbRating">
                                <span>{{model.imdbRating}}</span>
                                <span>{{' ('+model.imdbUserRatingsCount+') '}}</span>
                            </div>
                        </div>
                    </div>
                    <div id="little-stats">
                        <div style="margin-left: 20px;">
                            <div>
                                <h1>{{model.name}} 
                                    <button mat-mini-fab 
                                            (click)="openAnotherNamesDialog()" 
                                            title="Film Another Names">
                                                <mat-icon>info</mat-icon>
                                    </button>
                                </h1>
                            </div>
                            <div *ngIf="model.genres">
                                <button class="film-genre" *ngFor="let genre of model.genres" 
                                mat-raised-button color="primary">{{genre}}</button>
                            </div>
                            <div *ngIf="model.description" class="film-description">
                                {{model.description}}
                            </div>
                            <div *ngIf="model.releaseDate">
                                <mat-label>Release Date: {{formatDate(model.releaseDate)}}</mat-label>
                            </div>
                            <div *ngIf="model.countries">
                                <mat-label>Countries: </mat-label>
                                <button class="film-country" *ngFor="let country of model.countries" 
                                 mat-stroked-button color="primary">{{country}}</button>
                            </div>
                            <div *ngIf="model.companies">
                                <mat-label>Companies: </mat-label>
                                <button class="film-company" *ngFor="let company of model.companies" 
                                 mat-stroked-button color="primary">{{company.name}}</button>
                            </div>
                            <div *ngIf="model.tagline">
                                <mat-label>Tagline: </mat-label>
                                <mat-label>{{model.tagline}}</mat-label>
                            </div>
                            <div *ngIf="model.boxOffice" style="display: flex;">
                                <div *ngIf="model.boxOffice.budget">
                                    <mat-label>Budget: </mat-label>
                                    <mat-label>{{model.boxOffice.budget}}</mat-label>
                                </div>
                                <div *ngIf="model.boxOffice.gross" style="margin-left: 20px;">
                                    <mat-label>Gross: </mat-label>
                                    <mat-label>{{model.boxOffice.gross}}</mat-label>
                                </div>
                                <div *ngIf="model.boxOffice.openingWeekend" style="margin-left: 20px;">
                                    <mat-label>Opening Weekend: </mat-label>
                                    <mat-label>{{model.boxOffice.openingWeekend}}</mat-label>
                                </div>
                            </div> 
                            <div id="awards" style="display: flex">
                                <span id="model-awards">
                                    Award Information: {{model.awardsInformationString}}
                                </span>
                                <button mat-mini-fab 
                                        (click)="openAwardsDialog()" 
                                        title="Detailed Awards Information">
                                            <mat-icon>info</mat-icon>
                                </button>
                                <!-- <div id="fetched-awards" *ngIf="fetched" style="margin-left: 100px;">
                                    <mat-label>Award Information: </mat-label>
                                    <h1>{{fetched.awardsInformationString}}</h1>
                                </div> -->
                            </div>
                    </div>
                    </div>
                    <div id="edit-fetch-buttons">
                        <button mat-flat-button color="primary" (click)="editMode=!editMode">
                            {{editMode ? "View Mode" : "Edit Mode"}}
                        </button>
                        <button mat-flat-button color="primary" (click)="fetchFilmFromImdb()">
                            Fetch Film From Imdb
                        </button>
                    </div>
            </div>
            <div id="little-bio-for-fetched" *ngIf = "fetched" style="margin-left:50px; display: flex"> 
                <div id="photo2">
                            <!-- <mat-form-field appearance="fill"> -->
                                <img [src]="fetched.photo?.imdbPageUrl" 
                                *ngIf="fetched.photo" 
                                [alt]="fetched.photo?.title"
                                onerror="this.src='assets/DefaultMovie.png'">
                            <!-- </mat-form-field> -->
                    </div>
                    <div id="little-stats2">
                        <div style="margin-left: 200px;">
                            <div>
                                <mat-label *ngIf="editMode">Name: </mat-label>
                                <mat-form-field appearance="fill">
                                    <mat-label>Name:</mat-label>
                                    <input matInput class="matInput" [attr.disabled]="editMode ? null : ''" [value]="fetched?.name">
                                </mat-form-field>
                            </div>
                            <div>
                                <a target="_blank" href="{{fetched.imdbPageUrl}}">Visit Imdb Page</a>
                            </div>
                            <div>
                                <mat-label *ngIf="editMode">Description: </mat-label><br>
                                <mat-form-field appearance="fill">
                                    <mat-label>Description:</mat-label>
                                    <textarea matInput type="text" class="matInput" [attr.disabled]="editMode ? null : ''"  cols="50" rows="10" 
                                    [value]="fetched.description"></textarea>
                                </mat-form-field>
                            </div>
                            <br>
                            <div *ngIf="fetched.imdbRating">
                                <mat-label>Imdb Rating: </mat-label>
                                <mat-form-field appearance="fill">
                                    <mat-label>Imdb Rating: </mat-label>
                                    <input matInput class="matInput" [disabled]='!editMode' [value]="fetched.imdbRating">
                                </mat-form-field>
                            </div>
                            <div *ngIf="fetched.imdbUserRatingsCount">
                                <mat-label>Imdb User Ratings Count: </mat-label>
                                <mat-form-field appearance="fill">
                                    <mat-label>Imdb User Ratings Count: </mat-label>
                                    <input matInput class="matInput" [disabled]='!editMode' [value]="fetched.imdbUserRatingsCount">
                                </mat-form-field>
                            </div>
                            <div *ngIf="fetched.releaseDate">
                                <mat-label>Release Date: {{fetched.releaseDate}} </mat-label>
                                <mat-form-field appearance="fill">
                                    <mat-label>Release Date: </mat-label>
                                    <input matInput class="matInput" [disabled]='!editMode' [value]="fetched.releaseDate">
                                </mat-form-field>
                            </div>
                            <div *ngIf="fetched.tagline">
                                <mat-label>Tagline: {{fetched.tagline}}</mat-label>
                                <mat-form-field appearance="fill">
                                    <mat-label>Tagline: </mat-label>
                                    <input matInput class="matInput" [disabled]='!editMode' [value]="fetched.tagline">
                                </mat-form-field>
                            </div>
                            <div *ngIf="fetched.boxOffice">
                                <mat-label>Budget: </mat-label>
                                <mat-form-field appearance="fill">
                                    <mat-label>Budget: </mat-label>
                                    <input matInput class="matInput" [disabled]='!editMode' [value]="fetched.boxOffice.budget">
                                </mat-form-field>
                                <mat-label>Gross: </mat-label>
                                <mat-form-field appearance="fill">
                                    <mat-label>Gross: </mat-label>
                                    <input matInput class="matInput" [disabled]='!editMode' [value]="fetched.boxOffice.gross">
                                </mat-form-field>
                                <mat-label>Opening Weekend: </mat-label>
                                <mat-form-field appearance="fill">
                                    <mat-label>Opening Weekend: </mat-label>
                                    <input matInput class="matInput" [disabled]='!editMode' [value]="fetched.boxOffice.openingWeekend">
                                </mat-form-field>
                            </div> 
                            <div *ngIf="fetched.countries">
                                <mat-label>Countries: </mat-label>
                                <mat-label *ngFor="let country of fetched.countries">{{country}} </mat-label>
                            </div>
                            <div *ngIf="fetched.genres">
                                <mat-label>Genres: </mat-label>
                                <mat-label *ngFor="let genre of fetched.genres">{{genre}} </mat-label>
                            </div>
                    </div>
                </div>
                <div id="remove-button">
                    <button mat-flat-button color="primary" (click)="fetched=undefined">
                                Remove Fetched Result
                    </button>
                </div>
            </div>
        </div>
        <!-- <button mat-flat-button *ngIf="editMode" color="primary" type="submit">Save</button> -->
     
        <div style="display: flex;">
            <div *ngIf="model.directors">
                <span>Directors: </span>
                <div class="cast"> 
                    <mat-card 
                    class="cast-card"
                    *ngFor="let director of model.directors"
                    [routerLink]="director.id ? ['/person/'+director.id] : []"
                    [queryParams]="{flmCatName: 'director'}">
                        <img   
                        class="cast-image"
                        [src]="director.profilePicture?.imdbPageUrl" 
                            [title]="director.name"
                            (error)="setDefaultPersonPhoto($event, director)">
                        <mat-card-footer class="cast-footer">
                            <mat-card-title>{{director.name}}</mat-card-title>
                        </mat-card-footer>
                    </mat-card>
                </div>
            </div>
            <div *ngIf="model.writers">
                <span>Writers: </span>
                <div class="cast">
                        <mat-card *ngFor="let writer of model.writers"
                        class="cast-card" 
                        [routerLink]="writer.id ? ['/person/'+writer.id] : []"
                        [queryParams]="{flmCatName: 'writer'}">
                            <img  
                                class="cast-image"
                                [src]="writer.profilePicture?.imdbPageUrl" 
                                [title]="writer.name"
                                (error)="setDefaultPersonPhoto($event, writer)">
                            <mat-card-footer class="cast-footer">
                                <mat-card-title>{{writer.name}}</mat-card-title>
                            </mat-card-footer>
                        </mat-card>
                </div>
            </div> 
            <div *ngIf="cast">
                <span style="margin-left: 45px;">Cast: </span>
                <div class="cast">
                    <button mat-mini-fab [disabled]="leftCastArrowDisabled" 
                    (click)="castPageArrowClicked(false)">
                        <mat-icon>keyboard_arrow_left</mat-icon>
                    </button>
                    <mat-card *ngFor="let castMember of cast" class="cast-card" 
                    [routerLink]="castMember.id ? ['/person/'+castMember.id] : []">
                        <img class="cast-image"
                            [src]="castMember.profilePicture?.image" 
                            [title]="castMember.name"
                            (error)="setDefaultProfilePicture($event, castMember)">
                        <mat-card-footer class="cast-footer">
                            <mat-card-title>{{castMember.name}}</mat-card-title>
                            <hr>
                            <mat-card-subtitle *ngFor="let character of castMember.characters">
                                <a *ngIf="character.imdbPageUrl; else chOnlyName" target="_blank" href="{{character.imdbPageUrl}}">
                                    {{character?.name}}
                                </a>
                                <ng-template #chOnlyName>{{character?.name}}
                                    <p *ngIf="character.description"> ({{character.description}})</p>
                                </ng-template>
                            </mat-card-subtitle>
                        </mat-card-footer>
                    </mat-card>
                    <button mat-mini-fab [disabled]="rightCastArrowDisabled" 
                    (click)="castPageArrowClicked(true)">
                        <mat-icon>keyboard_arrow_right</mat-icon>
                    </button>
                </div>
                <div style="float: right">
                    <span>{{castCurrPage + 1}}/{{castPagesLength}}</span>
                    <button mat-mini-fab 
                        (click)="openCastAndCrewDialog()" 
                        title="All Cast And Crew">
                            <mat-icon>info</mat-icon>
                    </button>
                </div>
            </div>
        </div>
        <div id="photos" *ngIf="model.photos" style="display: block;">
            <span>Photos: 
                <button mat-mini-fab 
                    [routerLink]="['/film/'+id+'/photos']"
                    title="More Photos">
                        <mat-icon>info</mat-icon>
                </button>
            </span>
            <div class="film-photos">
                <div *ngFor="let photo of model.photos" class="film-photo">
                                <img [src]="photo?.image" 
                                [title]="photo?.title"
                                style="max-width: 200px;">
                </div>
            </div>   
        </div>
    </div>
</form>
